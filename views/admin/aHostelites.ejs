<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | Admin</title>
    <link rel="shortcut icon" href="./../static/favicon2.png" type="image/x-icon">
    <link rel="stylesheet" href="./adminDashboard.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
        integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">


    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Moo+Lah+Lah&family=Roboto+Condensed:wght@300&family=Rubik:wght@300&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
        integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
    <link rel="preconnect" href="https://fonts.googleapis.com">

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="./../home.css">


</head>

<body>
    <!-- navBar ====================================== -->
    <%- include('../../partials/navBar') %>



        <div class="dashboard-container">

            <!-- Admin Dashboard Bullets ======================== -->
            <%- include('aBullets') %>

                <!-- Admin Dashboard Body ==========================-->


                <div class="dashboard-body">

                    <!-- pending Applications will be visible here-->
                    <h3 class="pending-heading">Update Hostelites</h3>

                    <div class="admin-create-container">

                        <div class="admin-signup-box">
                            <div class="image-box">
                                <img src="./static/user-dp.jpg" alt="">
                            </div>

                            <div class="form-box">
                                <form action="" id="hostelite-update-form">
                                    <input type="text" placeholder="Enter ID of Hostelite" required name="hostelite_id">
                                    <input type="text" placeholder="Update Name" name="fullname">
                                    <input type="text" placeholder="Update Gender" name="gender">
                                    <input type="number" placeholder="Update Mobile Number" name="mobileNo">
                                    <input type="text" placeholder="Update College" name="college">
                                    <input type="text" placeholder="Update Dept" name="dept">
                                    <input type="number" placeholder="Update Hostel No." name="hostelNo">
                                    <input type="text" placeholder="Update Room No." name="roomNo">
                                    <label for="hostel-type" class="hostel-type">
                                        Room Type ?
                                        <select class="select-hostel-type">
                                            <option name="roomType" value="Single">Single</option>
                                            <option name="roomType" value="Sharing">Sharing</option>
                                        </select>
                                    </label>
                                    <div class="payment-status">
                                        <div>Payment Done ?</div>
                                        <label class="switch">
                                            <input type="checkbox">
                                            <span class="slider round"></span>
                                        </label>
                                    </div>

                                    <button type="submit">Update Hostelite</button>
                                </form>

                            </div>




                        </div>



                    </div>


                    <h3 class="pending-heading">Delete Hostelites</h3>

                    <div class="admin-create-container">

                        <div class="admin-signup-box">

                            <div class="form-box">
                                <form action="" id="hostelite-delete-form">
                                    <input type="text" placeholder="Enter ID of Hostelite" required name="hostelite_id">

                                    <button type="submit" style="color: white; background-color: #dc3545;">Delete
                                        Hostelite</button>
                                </form>

                            </div>




                        </div>



                    </div>

                </div>


                <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
                    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
                    crossorigin="anonymous"></script>

                <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>


                <script>
                    const Toast = Swal.mixin({
                        toast: true,
                        position: 'top-end',
                        showConfirmButton: false,
                        timer: 3000,
                        timerProgressBar: true,
                        didOpen: (toast) => {
                            toast.addEventListener('mouseenter', Swal.stopTimer)
                            toast.addEventListener('mouseleave', Swal.resumeTimer)
                        }
                    })

                    const hosteliteUpdateForm = document.getElementById("hostelite-update-form");
                    const hosteliteDeleteForm = document.getElementById("hostelite-delete-form");

                    hosteliteUpdateForm.addEventListener("submit", function (e) {
                        e.preventDefault();
                        const h_id = e.srcElement[0].value;
                        const h_name = e.srcElement[1].value;
                        const h_gender = e.srcElement[2].value;
                        const h_mobileNo = e.srcElement[3].value;
                        const h_college = e.srcElement[4].value;
                        const h_dept = e.srcElement[5].value;
                        const h_hostelNo = e.srcElement[6].value;
                        const h_roomNo = e.srcElement[7].value;
                        const h_roomType = e.srcElement[8].value;
                        const h_isPaid = e.srcElement[9].checked;

                        let updatedData = {};
                        if (h_name) {
                            updatedData.fullname = h_name;
                        }
                        if (h_gender) {
                            updatedData.gender = h_gender;
                        }
                        if (h_mobileNo) {
                            updatedData.mobileNo = h_mobileNo;
                        }
                        if (h_college) {
                            updatedData.college = h_college;
                        }
                        if (h_dept) {
                            updatedData.dept = h_dept;
                        }
                        if (h_hostelNo) {
                            updatedData.hostelNo = h_hostelNo;
                        }
                        if (h_roomNo) {
                            updatedData.roomNo = h_roomNo;
                        }
                        if (h_roomType) {
                            updatedData.roomType = h_roomType;
                        }
                        updatedData.isPaid = h_isPaid;

                        const updatedHostelite = fetch(`/hostelites/${h_id}`, {
                            method: "PATCH",
                            headers: {
                                "Content-Type": "application/json"
                            },
                            body: JSON.stringify(updatedData)
                        }).then(res => res.json())
                            .then((data) => {
                                Toast.fire({
                                    icon: 'success',
                                    title: 'Updated successfully'
                                })
                                hosteliteUpdateForm.reset();
                            }).catch((err) => {
                                console.log(err);
                            })

                    })

                    hosteliteDeleteForm.addEventListener("submit", function (e) {
                        e.preventDefault();
                        const h_id = e.srcElement[0].value;

                        const deleteHostelite = fetch(`/hostelites/${h_id}`, {
                            method: "DELETE",
                            headers: {
                                "Content-Type": "application/json"
                            }
                        }).then((data) => {
                            Toast.fire({
                                icon: 'success',
                                title: 'Deleted successfully'
                            })
                            hosteliteDeleteForm.reset();
                        }).catch((err) => {
                            console.log(err);
                        })

                    })

                </script>

</body>

</html>